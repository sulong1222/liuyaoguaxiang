<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…­çˆ»æ™ºèƒ½è§£å¦ç³»ç»Ÿ</title>
    <style>
        :root {
            --primary-color: #8b4513;
            --secondary-color: #d4af37;
            --bg-color: #f0e6d3;
        }
        body {
            font-family: 'æ¥·ä½“', cursive;
            background: var(--bg-color);
            color: var(--primary-color);
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .container {
            background: rgba(255,255,255,0.9);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        button {
            background: var(--primary-color);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: transform 0.2s;
        }
        button:hover {
            transform: scale(1.05);
        }
        .hexagram-box {
            margin: 2rem 0;
            padding: 1.5rem;
            background: rgba(139,69,19,0.1);
            border-radius: 8px;
        }
        .yao-line {
            font-size: 1.8rem;
            line-height: 1.5;
            margin: 0.5rem 0;
        }
        .changing-yao {
            color: #b22222;
            position: relative;
        }
        .changing-yao::after {
            content: "âœ¦";
            position: absolute;
            right: -1.2rem;
            color: #ffd700;
        }
        .tabs {
            display: flex;
            gap: 1rem;
            margin: 1.5rem 0;
        }
        .tab {
            padding: 0.8rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            background: var(--secondary-color);
            color: white;
            transition: all 0.3s;
        }
        .tab.active {
            background: var(--primary-color);
        }
        .interpretation {
            line-height: 1.8;
        }
        .element-tag {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.9rem;
            margin-left: 1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ€„ å…­çˆ»æ™ºèƒ½è§£å¦ç³»ç»Ÿ</h1>
        <button onclick="generateHexagram()">ğŸ™ è¯šå¿ƒæ‘‡å¦</button>
        <div id="result"></div>
    </div>

<script>
// å®Œæ•´å…­åå››å¦æ•°æ®åº“
const hexagramDict = {
  // ä¸Šç»ä¸‰åå¦
  '111111': { name: 'ä¹¾ä¸ºå¤©', desc: 'å…ƒäº¨åˆ©è´ã€‚', yao: [
    'åˆä¹ï¼šæ½œé¾™ï¼Œå‹¿ç”¨ã€‚',
    'ä¹äºŒï¼šè§é¾™åœ¨ç”°ï¼Œåˆ©è§å¤§äººã€‚',
    'ä¹ä¸‰ï¼šå›å­ç»ˆæ—¥ä¹¾ä¹¾ï¼Œå¤•æƒ•è‹¥ï¼Œå‰æ— å’ã€‚',
    'ä¹å››ï¼šæˆ–è·ƒåœ¨æ¸Šï¼Œæ— å’ã€‚',
    'ä¹äº”ï¼šé£é¾™åœ¨å¤©ï¼Œåˆ©è§å¤§äººã€‚',
    'ä¸Šä¹ï¼šäº¢é¾™æœ‰æ‚”ã€‚'
  ]},
  '000000': { name: 'å¤ä¸ºåœ°', desc: 'å›å­ä»¥åšå¾·è½½ç‰©ã€‚', yao: [
    'åˆå…­ï¼šå±¥éœœï¼Œåšå†°è‡³ã€‚',
    'å…­äºŒï¼šç›´æ–¹å¤§ï¼Œä¸ä¹ æ— ä¸åˆ©ã€‚',
    'å…­ä¸‰ï¼šå«ç« å¯è´ï¼Œæˆ–ä»ç‹äº‹ï¼Œæ— æˆæœ‰ç»ˆã€‚',
    'å…­å››ï¼šæ‹¬å›Šï¼Œæ— å’æ— èª‰ã€‚',
    'å…­äº”ï¼šé»„è£³ï¼Œå…ƒå‰ã€‚',
    'ä¸Šå…­ï¼šé¾™æˆ˜äºé‡ï¼Œå…¶è¡€ç„é»„ã€‚'
  ]},
  '100010': { name: 'æ°´é›·å±¯', desc: 'åˆšæŸ”å§‹äº¤è€Œéš¾ç”Ÿï¼ŒåŠ¨ä¹é™©ä¸­ï¼Œå¤§äº¨è´ã€‚' },
  '010001': { name: 'å±±æ°´è’™', desc: 'å±±ä¸‹å‡ºæ³‰ï¼Œè’™ï¼›å›å­ä»¥æœè¡Œè‚²å¾·ã€‚' },
  '111010': { name: 'æ°´å¤©éœ€', desc: 'äº‘ä¸Šäºå¤©ï¼Œéœ€ï¼›å›å­ä»¥é¥®é£Ÿå®´ä¹ã€‚' },
  '010111': { name: 'å¤©æ°´è®¼', desc: 'å¤©ä¸æ°´è¿è¡Œï¼Œè®¼ï¼›å›å­ä»¥ä½œäº‹è°‹å§‹ã€‚' },
  '010000': { name: 'åœ°æ°´å¸ˆ', desc: 'å›å­ä»¥å®¹æ°‘ç•œä¼—ã€‚' },
  '000010': { name: 'æ°´åœ°æ¯”', desc: 'åœ°ä¸Šæœ‰æ°´ï¼Œæ¯”ï¼›å…ˆç‹ä»¥å»ºä¸‡å›½ï¼Œäº²è¯¸ä¾¯ã€‚' },
  '111011': { name: 'é£å¤©å°ç•œ', desc: 'é£è¡Œå¤©ä¸Šï¼Œå°ç•œï¼›å›å­ä»¥æ‡¿æ–‡å¾·ã€‚' },
  '110111': { name: 'å¤©æ³½å±¥', desc: 'ä¸Šå¤©ä¸‹æ³½ï¼Œå±¥ï¼›å›å­ä»¥è¾¨ä¸Šä¸‹ï¼Œå®šæ°‘å¿—ã€‚' },
  '111000': { name: 'åœ°å¤©æ³°', desc: 'å¤©åœ°äº¤ï¼Œæ³°ï¼›åä»¥è´¢æˆå¤©åœ°ä¹‹é“ï¼Œè¾…ç›¸å¤©åœ°ä¹‹å®œï¼Œä»¥å·¦å³æ°‘ã€‚' },
  '000111': { name: 'å¤©åœ°å¦', desc: 'å¤©åœ°ä¸äº¤ï¼Œå¦ï¼›å›å­ä»¥ä¿­å¾·è¾Ÿéš¾ï¼Œä¸å¯è£ä»¥ç¦„ã€‚' },
  '101111': { name: 'å¤©ç«åŒäºº', desc: 'å¤©ä¸ç«ï¼ŒåŒäººï¼›å›å­ä»¥ç±»æ—è¾¨ç‰©ã€‚' },
  '111101': { name: 'ç«å¤©å¤§æœ‰', desc: 'ç«åœ¨å¤©ä¸Šï¼Œå¤§æœ‰ï¼›å›å­ä»¥éæ¶æ‰¬å–„ï¼Œé¡ºå¤©ä¼‘å‘½ã€‚' },
  '001000': { name: 'åœ°å±±è°¦', desc: 'å›å­ä»¥è£’å¤šç›Šå¯¡ï¼Œç§°ç‰©å¹³æ–½ã€‚' },
  '000100': { name: 'é›·åœ°è±«', desc: 'é›·å‡ºåœ°å¥‹ï¼Œè±«ï¼›å…ˆç‹ä»¥ä½œä¹å´‡å¾·ï¼Œæ®·èä¹‹ä¸Šå¸ï¼Œä»¥é…ç¥–è€ƒã€‚' },
  '110001': { name: 'æ³½é›·éš', desc: 'å›å­ä»¥å‘æ™¦å…¥å®´æ¯ã€‚' },
  '100011': { name: 'å±±é£è›Š', desc: 'å›å­ä»¥æŒ¯æ°‘è‚²å¾·ã€‚' },
  '110000': { name: 'åœ°æ³½ä¸´', desc: 'å›å­ä»¥æ•™æ€æ— ç©·ï¼Œå®¹ä¿æ°‘æ— ç–†ã€‚' },
  '000011': { name: 'é£åœ°è§‚', desc: 'é£è¡Œåœ°ä¸Šï¼Œè§‚ï¼›å…ˆç‹ä»¥çœæ–¹ï¼Œè§‚æ°‘è®¾æ•™ã€‚' },
  '100101': { name: 'ç«é›·å™¬å—‘', desc: 'é›·ç”µå™¬å—‘ï¼›å…ˆç‹ä»¥æ˜ç½šæ••æ³•ã€‚' },
  '101001': { name: 'å±±ç«è´²', desc: 'å›å­ä»¥æ˜åº¶æ”¿ï¼Œæ— æ•¢æŠ˜ç‹±ã€‚' },
  '000001': { name: 'å±±åœ°å‰¥', desc: 'å±±é™„äºåœ°ï¼Œå‰¥ï¼›ä¸Šä»¥åšä¸‹å®‰å®…ã€‚' },
  '100000': { name: 'åœ°é›·å¤', desc: 'é›·åœ¨åœ°ä¸­ï¼Œå¤ï¼›å…ˆç‹ä»¥è‡³æ—¥é—­å…³ï¼Œå•†æ—…ä¸è¡Œã€‚' },
  '100111': { name: 'å¤©é›·æ— å¦„', desc: 'å¤©ä¸‹é›·è¡Œï¼Œç‰©ä¸æ— å¦„ï¼›å…ˆç‹ä»¥èŒ‚å¯¹æ—¶ï¼Œè‚²ä¸‡ç‰©ã€‚' },
  '111001': { name: 'å±±å¤©å¤§ç•œ', desc: 'å¤©åœ¨å±±ä¸­ï¼Œå¤§ç•œï¼›å›å­ä»¥å¤šè¯†å‰è¨€å¾€è¡Œï¼Œä»¥ç•œå…¶å¾·ã€‚' },
  '100001': { name: 'å±±é›·é¢', desc: 'å›å­ä»¥æ…è¨€è¯­ï¼ŒèŠ‚é¥®é£Ÿã€‚' },
  '011110': { name: 'æ³½é£å¤§è¿‡', desc: 'å›å­ä»¥ç‹¬ç«‹ä¸æƒ§ï¼Œéä¸–æ— é—·ã€‚' },
  '010010': { name: 'åä¸ºæ°´', desc: 'æ°´æ´Šè‡³ï¼Œä¹ åï¼›å›å­ä»¥å¸¸å¾·è¡Œï¼Œä¹ æ•™äº‹ã€‚' },
  '101101': { name: 'ç¦»ä¸ºç«', desc: 'æ˜ä¸¤ä½œï¼Œç¦»ï¼›å¤§äººä»¥ç»§æ˜ç…§äºå››æ–¹ã€‚' },

  // ä¸‹ç»ä¸‰åå››å¦
  '001110': { name: 'æ³½å±±å’¸', desc: 'å›å­ä»¥è™šå—äººã€‚' },
  '011100': { name: 'é›·é£æ’', desc: 'å›å­ä»¥ç«‹ä¸æ˜“æ–¹ã€‚' },
  '111110': { name: 'å¤©å±±é', desc: 'å›å­ä»¥è¿œå°äººï¼Œä¸æ¶è€Œä¸¥ã€‚' },
  '011111': { name: 'é›·å¤©å¤§å£®', desc: 'å›å­ä»¥éç¤¼å¼—å±¥ã€‚' },
  '000101': { name: 'ç«åœ°æ™‹', desc: 'å›å­ä»¥è‡ªæ˜­æ˜å¾·ã€‚' },
  '101000': { name: 'åœ°ç«æ˜å¤·', desc: 'å›å­ä»¥è…ä¼—ï¼Œç”¨æ™¦è€Œæ˜ã€‚' },
  '110101': { name: 'é£ç«å®¶äºº', desc: 'å›å­ä»¥è¨€æœ‰ç‰©è€Œè¡Œæœ‰æ’ã€‚' },
  '101011': { name: 'ç«æ³½ç½', desc: 'å›å­ä»¥åŒè€Œå¼‚ã€‚' },
  '001010': { name: 'æ°´å±±è¹‡', desc: 'å›å­ä»¥åèº«ä¿®å¾·ã€‚' },
  '010100': { name: 'é›·æ°´è§£', desc: 'å›å­ä»¥èµ¦è¿‡å®¥ç½ªã€‚' },
  '110001': { name: 'å±±æ³½æŸ', desc: 'å›å­ä»¥æƒ©å¿¿çª’æ¬²ã€‚' },
  '100011': { name: 'é£é›·ç›Š', desc: 'å›å­ä»¥è§å–„åˆ™è¿ï¼Œæœ‰è¿‡åˆ™æ”¹ã€‚' },
  '111110': { name: 'æ³½å¤©å¤¬', desc: 'å›å­ä»¥æ–½ç¦„åŠä¸‹ï¼Œå±…å¾·åˆ™å¿Œã€‚' },
  '011111': { name: 'å¤©é£å§¤', desc: 'åä»¥æ–½å‘½è¯°å››æ–¹ã€‚' },
  '000110': { name: 'æ³½åœ°èƒ', desc: 'å›å­ä»¥é™¤æˆå™¨ï¼Œæˆ’ä¸è™ã€‚' },
  '011000': { name: 'åœ°é£å‡', desc: 'å›å­ä»¥é¡ºå¾·ï¼Œç§¯å°ä»¥é«˜å¤§ã€‚' },
  '010110': { name: 'æ³½æ°´å›°', desc: 'å›å­ä»¥è‡´å‘½é‚å¿—ã€‚' },
  '011010': { name: 'æ°´é£äº•', desc: 'å›å­ä»¥åŠ³æ°‘åŠç›¸ã€‚' },
  '101110': { name: 'æ³½ç«é©', desc: 'å›å­ä»¥æ²»å†æ˜æ—¶ã€‚' },
  '011101': { name: 'ç«é£é¼', desc: 'å›å­ä»¥æ­£ä½å‡å‘½ã€‚' },
  '100100': { name: 'éœ‡ä¸ºé›·', desc: 'å›å­ä»¥ææƒ§ä¿®çœã€‚' },
  '001001': { name: 'è‰®ä¸ºå±±', desc: 'å›å­ä»¥æ€ä¸å‡ºå…¶ä½ã€‚' },
  '001011': { name: 'é£å±±æ¸', desc: 'å›å­ä»¥å±…è´¤å¾·å–„ä¿—ã€‚' },
  '110100': { name: 'é›·æ³½å½’å¦¹', desc: 'å›å­ä»¥æ°¸ç»ˆçŸ¥æ•ã€‚' },
  '101100': { name: 'é›·ç«ä¸°', desc: 'å›å­ä»¥æŠ˜ç‹±è‡´åˆ‘ã€‚' },
  '001101': { name: 'ç«å±±æ—…', desc: 'å›å­ä»¥æ˜æ…ç”¨åˆ‘è€Œä¸ç•™ç‹±ã€‚' },
  '011001': { name: 'å·½ä¸ºé£', desc: 'å›å­ä»¥ç”³å‘½è¡Œäº‹ã€‚' },
  '100110': { name: 'å…‘ä¸ºæ³½', desc: 'å›å­ä»¥æœ‹å‹è®²ä¹ ã€‚' },
  '011000': { name: 'é£æ°´æ¶£', desc: 'å…ˆç‹ä»¥äº«äºå¸ç«‹åº™ã€‚' },
  '000110': { name: 'æ°´æ³½èŠ‚', desc: 'å›å­ä»¥åˆ¶æ•°åº¦ï¼Œè®®å¾·è¡Œã€‚' },
  '110110': { name: 'é£æ³½ä¸­å­š', desc: 'å›å­ä»¥è®®ç‹±ç¼“æ­»ã€‚' },
  '001001': { name: 'é›·å±±å°è¿‡', desc: 'å›å­ä»¥è¡Œè¿‡ä¹æ­ï¼Œä¸§è¿‡ä¹å“€ï¼Œç”¨è¿‡ä¹ä¿­ã€‚' },
  '101010': { name: 'æ°´ç«æ—¢æµ', desc: 'å›å­ä»¥æ€æ‚£è€Œè±«é˜²ä¹‹ã€‚' },
  '010101': { name: 'ç«æ°´æœªæµ', desc: 'å›å­ä»¥æ…è¾¨ç‰©å±…æ–¹ã€‚' }
};

// äº”è¡Œç”Ÿå…‹å…³ç³»
const ELEMENT_RELATIONS = {
    'é‡‘': { generate: 'æ°´', restrict: 'æœ¨' },
    'æœ¨': { generate: 'ç«', restrict: 'åœŸ' },
    'æ°´': { generate: 'æœ¨', restrict: 'ç«' },
    'ç«': { generate: 'åœŸ', restrict: 'é‡‘' },
    'åœŸ': { generate: 'é‡‘', restrict: 'æ°´' }
};

class HexagramSystem {
    constructor() {
        this.current = null;
    }

    // ç”Ÿæˆå¦è±¡ï¼ˆå«å˜çˆ»ï¼‰
    generate() {
        let hexKey = '';
        const changes = [];
        
        for(let i=0; i<6; i++) {
            const rand = Math.floor(Math.random() * 6); // æ¨¡æ‹Ÿé“œé’±æ¦‚ç‡
            const state = this.getYaoState(rand);
            hexKey += state.value;
            if(state.changing) changes.push(i);
        }
        
        this.current = {
            original: this.getHexData(hexKey),
            changingLines: changes,
            changed: this.getChangedHex(hexKey, changes)
        };
    }

    getYaoState(num) {
        // 0-3å¯¹åº”ï¼šå°‘é˜´(0)ã€å°‘é˜³(1)ã€è€é˜´(2)ã€è€é˜³(3)
        return {
            0: {value:0, changing:false},
            1: {value:1, changing:false},
            2: {value:0, changing:true}, // è€é˜´å˜é˜³
            3: {value:1, changing:true}, // è€é˜³å˜é˜´
            4: {value:0, changing:false},
            5: {value:1, changing:false}
        }[num];
    }

    getHexData(key) {
        return HEXAGRAM_DB[key] || {name: 'æœªçŸ¥å¦', element: '', advice: {}};
    }

    getChangedHex(originalKey, changes) {
        if(changes.length === 0) return null;
        const arr = originalKey.split('');
        changes.forEach(pos => {
            arr[pos] = arr[pos] === '1' ? '0' : '1';
        });
        return this.getHexData(arr.join(''));
    }

    // ç”Ÿæˆè§£å¦æŠ¥å‘Š
    generateReport(type = 'overall') {
        const { original, changed, changingLines } = this.current;
        const elementAnalysis = this.analyzeElements(original, changed);
        
        return `
            <h3>${original.name} ${this.getElementTag(original.element)}</h3>
            ${this.renderHexagram(original, changingLines)}
            ${changed ? `<p class="changed">å˜å¦ï¼š${changed.name}</p>` : ''}
            
            <div class="tabs">
                ${['overall', 'career', 'love', 'health'].map(t => `
                    <div class="tab ${t === type ? 'active' : ''}" 
                         onclick="hexSystem.showTab('${t}')">${this.getTabName(t)}</div>
                `).join('')}
            </div>
            
            <div class="interpretation">
                ${this.getAdviceContent(original, type)}
                ${elementAnalysis}
                ${this.getChangingTips(changingLines)}
            </div>
        `;
    }

    getElementTag(element) {
        const colors = {é‡‘:'#ffd700',æœ¨:'#228b22',æ°´:'#1e90ff',ç«:'#ff4500',åœŸ:'#cd853f'};
        return `<span class="element-tag" style="background:${colors[element]}">${element}è¡Œ</span>`;
    }

    renderHexagram(hex, changes) {
        return hex.name.split('').reverse().map((_, i) => {
            const yao = hex.key[5-i]; // ä»ä¸‹åˆ°ä¸Šæ˜¾ç¤º
            return `<div class="yao-line ${changes.includes(5-i) ? 'changing-yao' : ''}">
                ${yao === '1' ? 'â–…â–…â–…â–…â–…' : 'â–…â–…ã€€â–…â–…'}
            </div>`;
        }).join('');
    }

    analyzeElements(original, changed) {
        if(!changed) return '';
        const oElem = original.element;
        const cElem = changed.element;
        const relation = ELEMENT_RELATIONS[oElem];
        
        let analysis = '';
        if(relation.generate === cElem) analysis = 'ğŸŸ¢ äº”è¡Œç›¸ç”Ÿï¼ˆå‰ï¼‰';
        else if(relation.restrict === cElem) analysis = 'ğŸ”´ äº”è¡Œç›¸å…‹ï¼ˆå‡¶ï¼‰';
        else analysis = 'ğŸŸ¡ äº”è¡Œå¹³å’Œï¼ˆä¸­ï¼‰';
        
        return `<div class="element-analysis">${analysis}</div>`;
    }

    getChangingTips(changes) {
        if(changes.length === 0) return '';
        return `<div class="changing-tips">
            <h4>åŠ¨çˆ»è§£æï¼š</h4>
            <ul>${changes.map(pos => `
                <li>ç¬¬${pos+1}çˆ»ï¼ˆ${this.current.original.relations[pos]}ï¼‰ï¼š
                ${this.current.original.changingTips?.[pos] || 'æ— ç‰¹åˆ«æç¤º'}</li>
            `).join('')}</ul>
        </div>`;
    }

    getAdviceContent(hex, type) {
        return `<div class="advice-content">
            <h4>${this.getTabName(type)}å»ºè®®ï¼š</h4>
            <p>${hex.advice[type] || 'æš‚æ— ä¸“é¡¹å»ºè®®'}</p>
        </div>`;
    }

    getTabName(type) {
        return {overall:'æ•´ä½“', career:'äº‹ä¸š', love:'æ„Ÿæƒ…', health:'å¥åº·'}[type];
    }

    showTab(type) {
        document.getElementById('result').innerHTML = this.generateReport(type);
    }
}

// åˆå§‹åŒ–ç³»ç»Ÿ
const hexSystem = new HexagramSystem();

function generateHexagram() {
    hexSystem.generate();
    hexSystem.showTab('overall');
}
</script>
</body>
</html>
